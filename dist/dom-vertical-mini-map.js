(function e(t,n){if(typeof exports==="object"&&typeof module==="object")module.exports=n();else if(typeof define==="function"&&define.amd)define([],n);else if(typeof exports==="object")exports["DomVerticalMiniMap"]=n();else t["DomVerticalMiniMap"]=n()})(window,function(){return function(e){var t={};function n(l){if(t[l]){return t[l].exports}var r=t[l]={i:l,l:false,exports:{}};e[l].call(r.exports,r,r.exports,n);r.l=true;return r.exports}n.m=e;n.c=t;n.d=function(e,t,l){if(!n.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:l})}};n.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};n.t=function(e,t){if(t&1)e=n(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var l=Object.create(null);n.r(l);Object.defineProperty(l,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var r in e)n.d(l,r,function(t){return e[t]}.bind(null,r));return l};n.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};n.d(t,"a",t);return t};n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};n.p="";return n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});n(1);var l=n(3);var r=o(l);function o(e){return e&&e.__esModule?e:{default:e}}t.default=r.default},function(e,t,n){},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var l=t[n];l.enumerable=l.enumerable||false;l.configurable=true;if("value"in l)l.writable=true;Object.defineProperty(e,l.key,l)}}return function(t,n,l){if(n)e(t.prototype,n);if(l)e(t,l);return t}}();function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.styles;n=n===undefined?{}:n;var l=n.backgroundColor,o=l===undefined?"rgba(248, 249, 250, 1)":l,i=n.borderColor,s=i===undefined?"rgba(108, 117, 125, 1)":i,a=n.position,u=a===undefined?"right":a,c=n.width,d=c===undefined?"1rem":c,f=n.zIndex,m=f===undefined?1e3:f,v=t.scroll;v=v===undefined?{}:v;var p=v.enabled,h=p===undefined?true:p,y=v.styles;y=y===undefined?{}:y;var b=y.backgroundColor,E=b===undefined?"rgba(108, 117, 125, 0.3)":b,_=t.points,g=_===undefined?[]:_;r(this,e);this._version="0.0.1";this._mapElement=null;this._scrollElement=null;this._mutationObserver=null;this._mapPoints=[];this._mapElementStyles={backgroundColor:o,borderColor:s,position:["right","left"].includes(u)?u:"right",width:d,zIndex:m};this._isScrollElementEnabled=typeof h==="boolean"?h:true;this._scrollElementStyles={backgroundColor:E};this._points=g}l(e,[{key:"_init",value:function e(){var t=this._isScrollElementEnabled;this._initMapElement();if(t){this._initScrollElement()}this._initMapPoints();window.addEventListener("resize",this._setMapPointStyles.bind(this));var n=this._mapElement;if(t){n.appendChild(this._scrollElement)}var l=document.documentElement||document.body;l.appendChild(n);this._initMutationObserver();this._mutationObserver.observe(l,{attributes:true,characterData:true,childList:true,subtree:true})}},{key:"_initMapElement",value:function t(){this._mapElement=document.createElement("div");var n=this._mapElement;var l=this._mapElementStyles;var r=l["width"];n.classList.add("dom-vertical-mini-map");n.style.backgroundColor=l["backgroundColor"];n.style.width=r;n.style.borderColor=l["borderColor"];n.style.zIndex=l["zIndex"].toString();if(l.position==="left"){n.style.left="0";n.style.right="calc(100% - "+r+")";n.style.borderRightWidth="1px"}else{n.style.right="0";n.style.left="calc(100% - "+r+")";n.style.borderLeftWidth="1px"}n.addEventListener("click",e.scrollDocumentTo.bind(event))}},{key:"_initMapPoints",value:function t(){var n=this._mapPoints;var l=this._points;var r=n.map(function(e){return e["element"]});var o=[];for(var i=0,s=l.length;i<s;++i){var a=l[i];var u=a["draw"]||{};var c=u["selector"];if(c==null){continue}var d=u["selectorContains"];var f=u["styles"]||{};var m=f["backgroundColor"];var v=f["outlineColor"];var p=a["focus"]||{};var h=p["enabled"]||false;var y=p["selector"];var b=a["scroll"]||{};var E=b["enabled"]||true;var _=b["selector"];var g=b["type"]||"top";var S=a["titleConstructor"]||[];var w=document.querySelectorAll(c);for(var k=0,C=w.length;k<C;++k){var P=w[k];if(d!=null){if(P.querySelector(d)==null){continue}}o.push(P);if(r.includes(P)){continue}var M={element:P,focusElement:null,marker:document.createElement("div"),scrollElement:null,scrollEnabled:E,scrollType:g,styles:{backgroundColor:m,outlineColor:v}};if(h){M["focusElement"]=y==null?P:P.querySelector(y)}if(E){M["scrollElement"]=_==null?P:P.querySelector(_)}var x=S.length;var T=x?"":null;for(var O=0;O<x;++O){var H=S[O];if(H.hasOwnProperty("text")){var D=H["text"];T=O===0?D:T+"\n"+D;continue}var L=H["selector"];var j=L==null?P:P.querySelector(L);if(j!=null){var z=j["textContent"]||false;if(z){var I=j.textContent;if(I!=null){T=O===0?I:T+"\n"+I}continue}if(H.hasOwnProperty("attribute")){var V=j.getAttribute(H["attribute"]);if(V!=null){T=O===0?V:T+"\n"+V}}}}var q=M["marker"];if(T!=null){q.title=T}if(E){q.addEventListener("click",e.scrollDocumentToElement.bind(null,{focusElement:M["focusElement"],scrollElement:M["scrollElement"],scrollType:M["scrollType"]}))}n.push(M)}}var Y=document.createDocumentFragment();var A=n.length;var R=this._mapElementStyles;var W=R["borderColor"];var B=R["zIndex"];while(A--){var F=n[A];var G=F["element"];var J=F["marker"];var K=F["styles"];var N=F["scrollEnabled"];J.classList.add("dom-vertical-mini-map-point");J.style.outlineColor=K["outlineColor"]||W;J.style.backgroundColor=K["backgroundColor"]||"rgba(220, 53, 69, 1)";J.style.zIndex=(B+1).toString();if(o.includes(G)){Y.appendChild(J)}else{if(N){J.removeEventListener("click",e.scrollDocumentToElement.bind(null,{focusElement:F["focusElement"],scrollElement:F["scrollElement"],scrollType:F["scrollType"]}))}J.remove();n.splice(A,1)}}this._mapElement.appendChild(Y)}},{key:"_initMutationObserver",value:function e(){var t=this;this._mutationObserver=new MutationObserver(function(e){return e.forEach(function(e){var n=e.target;if(!t._mapElement.contains(n)){if(t._isScrollElementEnabled){t._setScrollElementStyle()}t._initMapPoints();t._setMapPointStyles()}})})}},{key:"_initScrollElement",value:function e(){this._scrollElement=document.createElement("div");var t=this._scrollElement;t.classList.add("dom-vertical-mini-map-scroll");t.style.backgroundColor=this._scrollElementStyles["backgroundColor"];t.style.zIndex=(this._mapElementStyles["zIndex"]+2).toString();window.addEventListener("scroll",this._setScrollElementStyle.bind(this));window.addEventListener("resize",this._setScrollElementStyle.bind(this))}},{key:"_setMapPointStyles",value:function t(){var n=this._mapPoints;var l=e.getDocumentProperties(),r=l.documentHeight;for(var o=0,i=n.length;o<i;++o){var s=n[o];var a=s["marker"];var u=e.getElementCoordinates(s["element"]),c=u.bottom,d=u.top;a.style.bottom=100/r*(r-c)+"%";a.style.top=100/r*d+"%"}}},{key:"_setScrollElementStyle",value:function t(){var n=this._scrollElement;var l=e.getDocumentProperties(),r=l.windowHeight,o=l.documentHeight,i=l.documentScrollTop;if(r<o){n.style.display="block";n.style.bottom=100/o*(o-i-r)+"%";n.style.top=100/o*i+"%"}else{n.style.display="none"}}},{key:"create",value:function e(){this._init();var t=this._isScrollElementEnabled;if(t){this._setScrollElementStyle()}this._setMapPointStyles()}},{key:"destroy",value:function t(){var n=this._mapElement;var l=this._isScrollElementEnabled;this._mutationObserver.disconnect();this._mutationObserver=null;n.removeEventListener("click",e.scrollDocumentTo.bind(event));window.removeEventListener("resize",this._setMapPointStyles.bind(this));if(l){window.removeEventListener("scroll",this._setScrollElementStyle.bind(this));window.removeEventListener("resize",this._setScrollElementStyle.bind(this));this._scrollElement.remove();this._scrollElement=null}var r=this._mapPoints;for(var o=0,i=r.length;o<i;++o){var s=r[o];s["marker"].remove()}this._mapPoints=[];n.remove();this._mapElement=null}},{key:"refresh",value:function e(){this._initMapPoints();this._setMapPointStyles();if(this._isScrollElementEnabled){this._setScrollElementStyle()}}},{key:"root",get:function e(){return this._mapElement}},{key:"version",get:function e(){return this._version}}],[{key:"getElementCoordinates",value:function e(t){var n=t.getBoundingClientRect();var l=document.body;var r=document.documentElement;var o=window.pageYOffset||r.scrollTop||l.scrollTop;var i=r.clientTop||l.clientTop||0;var s=n.top+o-i;return{top:s,bottom:s+t.offsetHeight}}},{key:"getDocumentProperties",value:function e(){var t=document.body;var n=document.documentElement;var l=n.clientHeight;var r=Math.max(t.scrollHeight,n.scrollHeight,t.offsetHeight,n.offsetHeight,t.clientHeight,l);return{windowHeight:l,documentHeight:r,documentScrollTop:window.pageYOffset||n.scrollTop}}},{key:"scrollDocumentTo",value:function t(n){var l=e.getDocumentProperties(),r=l.windowHeight,o=l.documentHeight;window.scrollTo(0,o/r*n["clientY"])}},{key:"scrollDocumentToElement",value:function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},l=n.focusElement,r=l===undefined?null:l,o=n.scrollElement,i=o===undefined?null:o,s=n.scrollType,a=s===undefined?"top":s;var u=arguments[1];var c=null;if(r!=null){r.focus();c=r}if(i!=null){c=i}if(c==null){u.stopPropagation();return}if(a==="top"){c.scrollIntoView(true)}else if(a==="bottom"){c.scrollIntoView(false)}else if(a==="middle"){var d=e.getDocumentProperties(),f=d.windowHeight,m=d.documentHeight;var v=e.getElementCoordinates(c),p=v.top;var h=f/2;if(p-h<0){c.scrollIntoView(true)}else{if(p+h>m){c.scrollIntoView(false)}else{window.scrollTo(0,p-h)}}}u.stopPropagation()}}]);return e}();t.default=o}])["default"]});
//# sourceMappingURL=dom-vertical-mini-map.js.map