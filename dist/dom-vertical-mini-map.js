(function e(t,n){if(typeof exports==="object"&&typeof module==="object")module.exports=n();else if(typeof define==="function"&&define.amd)define([],n);else if(typeof exports==="object")exports["DomVerticalMiniMap"]=n();else t["DomVerticalMiniMap"]=n()})(window,function(){return function(n){var l={};function r(e){if(l[e]){return l[e].exports}var t=l[e]={i:e,l:false,exports:{}};n[e].call(t.exports,t,t.exports,r);t.l=true;return t.exports}r.m=n;r.c=l;r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:n})}};r.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};r.t=function(t,e){if(e&1)t=r(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var n=Object.create(null);r.r(n);Object.defineProperty(n,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var l in t)r.d(n,l,function(e){return t[e]}.bind(null,l));return n};r.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};r.d(e,"a",e);return e};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});n(1);var l=n(2);var r=o(l);function o(e){return e&&e.__esModule?e:{default:e}}t.default=r.default},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var l=function(){function l(e,t){for(var n=0;n<t.length;n++){var l=t[n];l.enumerable=l.enumerable||false;l.configurable=true;if("value"in l)l.writable=true;Object.defineProperty(e,l.key,l)}}return function(e,t,n){if(t)l(e.prototype,t);if(n)l(e,n);return e}}();function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=function(){function N(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.styles;t=t===undefined?{}:t;var n=t.backgroundColor,l=n===undefined?"rgba(248, 249, 250, 1)":n,r=t.borderColor,o=r===undefined?"rgba(108, 117, 125, 1)":r,i=t.position,s=i===undefined?"right":i,a=t.width,u=a===undefined?"1rem":a,c=t.zIndex,d=c===undefined?1e3:c,f=e.scroll;f=f===undefined?{}:f;var m=f.enabled,v=m===undefined?true:m,p=f.styles;p=p===undefined?{}:p;var h=p.backgroundColor,y=h===undefined?"rgba(108, 117, 125, 0.3)":h,b=e.points,E=b===undefined?[]:b;_(this,N);this._version="0.0.1";this._mapElement=null;this._scrollElement=null;this._mutationObserver=null;this._mapPoints=[];this._mapElementStyles={backgroundColor:l,borderColor:o,position:["right","left"].includes(s)?s:"right",width:u,zIndex:d};this._isScrollElementEnabled=typeof v==="boolean"?v:true;this._scrollElementStyles={backgroundColor:y};this._points=E}l(N,[{key:"_init",value:function e(){var t=this._isScrollElementEnabled;this._initMapElement();if(t){this._initScrollElement()}this._initMapPoints();window.addEventListener("resize",this._setMapPointStyles.bind(this));var n=this._mapElement;if(t){n.appendChild(this._scrollElement)}var l=document.documentElement||document.body;l.appendChild(n);this._initMutationObserver();this._mutationObserver.observe(l,{attributes:true,characterData:true,childList:true,subtree:true})}},{key:"_initMapElement",value:function e(){this._mapElement=document.createElement("div");var t=this._mapElement;var n=this._mapElementStyles;var l=n["width"];t.classList.add("dom-vertical-mini-map");t.style.backgroundColor=n["backgroundColor"];t.style.width=l;t.style.borderColor=n["borderColor"];t.style.zIndex=n["zIndex"].toString();if(n.position==="left"){t.style.left="0";t.style.right="calc(100% - "+l+")";t.style.borderRightWidth="1px"}else{t.style.right="0";t.style.left="calc(100% - "+l+")";t.style.borderLeftWidth="1px"}t.addEventListener("click",N.scrollDocumentTo.bind(event))}},{key:"_initMapPoints",value:function e(){var t=this._mapPoints;var n=this._points;var l=t.map(function(e){return e["element"]});var r=[];for(var o=0,i=n.length;o<i;++o){var s=n[o];var a=s["draw"]||{};var u=a["selector"];if(u==null){continue}var c=a["selectorContains"];var d=a["styles"]||{};var f=d["backgroundColor"];var m=d["outlineColor"];var v=s["focus"]||{};var p=v["enabled"]||false;var h=v["selector"];var y=s["scroll"]||{};var b=y["enabled"]||true;var E=y["selector"];var _=y["type"]||"top";var g=s["titleConstructor"]||[];var S=document.querySelectorAll(u);for(var w=0,k=S.length;w<k;++w){var C=S[w];if(c!=null){if(C.querySelector(c)==null){continue}}r.push(C);if(l.includes(C)){continue}var P={element:C,focusElement:null,marker:document.createElement("div"),scrollElement:null,scrollEnabled:b,scrollType:_,styles:{backgroundColor:f,outlineColor:m}};if(p){P["focusElement"]=h==null?C:C.querySelector(h)}if(b){P["scrollElement"]=E==null?C:C.querySelector(E)}var M=g.length;var x=M?"":null;for(var T=0;T<M;++T){var O=g[T];if(O.hasOwnProperty("text")){var H=O["text"];x=T===0?H:x+"\n"+H;continue}var D=O["selector"];var L=D==null?C:C.querySelector(D);if(L!=null){var j=L["textContent"]||false;if(j){var z=L.textContent;if(z!=null){x=T===0?z:x+"\n"+z}continue}if(O.hasOwnProperty("attribute")){var I=L.getAttribute(O["attribute"]);if(I!=null){x=T===0?I:x+"\n"+I}}}}var V=P["marker"];if(x!=null){V.title=x}if(b){V.addEventListener("click",N.scrollDocumentToElement.bind(null,{focusElement:P["focusElement"],scrollElement:P["scrollElement"],scrollType:P["scrollType"]}))}t.push(P)}}var q=document.createDocumentFragment();var Y=t.length;var A=this._mapElementStyles;var R=A["borderColor"];var W=A["zIndex"];while(Y--){var B=t[Y];var F=B["element"];var G=B["marker"];var J=B["styles"];var K=B["scrollEnabled"];G.classList.add("dom-vertical-mini-map-point");G.style.outlineColor=J["outlineColor"]||R;G.style.backgroundColor=J["backgroundColor"]||"rgba(220, 53, 69, 1)";G.style.zIndex=(W+1).toString();if(r.includes(F)){q.appendChild(G)}else{if(K){G.removeEventListener("click",N.scrollDocumentToElement.bind(null,{focusElement:B["focusElement"],scrollElement:B["scrollElement"],scrollType:B["scrollType"]}))}G.remove();t.splice(Y,1)}}this._mapElement.appendChild(q)}},{key:"_initMutationObserver",value:function e(){var n=this;this._mutationObserver=new MutationObserver(function(e){return e.forEach(function(e){var t=e.target;if(!n._mapElement.contains(t)){if(n._isScrollElementEnabled){n._setScrollElementStyle()}n._initMapPoints();n._setMapPointStyles()}})})}},{key:"_initScrollElement",value:function e(){this._scrollElement=document.createElement("div");var t=this._scrollElement;t.classList.add("dom-vertical-mini-map-scroll");t.style.backgroundColor=this._scrollElementStyles["backgroundColor"];t.style.zIndex=(this._mapElementStyles["zIndex"]+2).toString();window.addEventListener("scroll",this._setScrollElementStyle.bind(this));window.addEventListener("resize",this._setScrollElementStyle.bind(this))}},{key:"_setMapPointStyles",value:function e(){var t=this._mapPoints;var n=N.getDocumentProperties(),l=n.documentHeight;for(var r=0,o=t.length;r<o;++r){var i=t[r];var s=i["marker"];var a=N.getElementCoordinates(i["element"]),u=a.bottom,c=a.top;s.style.bottom=100/l*(l-u)+"%";s.style.top=100/l*c+"%"}}},{key:"_setScrollElementStyle",value:function e(){var t=this._scrollElement;var n=N.getDocumentProperties(),l=n.windowHeight,r=n.documentHeight,o=n.documentScrollTop;if(l<r){t.style.display="block";t.style.bottom=100/r*(r-o-l)+"%";t.style.top=100/r*o+"%"}else{t.style.display="none"}}},{key:"create",value:function e(){this._init();var t=this._isScrollElementEnabled;if(t){this._setScrollElementStyle()}this._setMapPointStyles()}},{key:"destroy",value:function e(){var t=this._mapElement;var n=this._isScrollElementEnabled;this._mutationObserver.disconnect();this._mutationObserver=null;t.removeEventListener("click",N.scrollDocumentTo.bind(event));window.removeEventListener("resize",this._setMapPointStyles.bind(this));if(n){window.removeEventListener("scroll",this._setScrollElementStyle.bind(this));window.removeEventListener("resize",this._setScrollElementStyle.bind(this));this._scrollElement.remove();this._scrollElement=null}var l=this._mapPoints;for(var r=0,o=l.length;r<o;++r){var i=l[r];i["marker"].remove()}this._mapPoints=[];t.remove();this._mapElement=null}},{key:"refresh",value:function e(){this._initMapPoints();this._setMapPointStyles();if(this._isScrollElementEnabled){this._setScrollElementStyle()}}},{key:"root",get:function e(){return this._mapElement}},{key:"version",get:function e(){return this._version}}],[{key:"getElementCoordinates",value:function e(t){var n=t.getBoundingClientRect();var l=document.body;var r=document.documentElement;var o=window.pageYOffset||r.scrollTop||l.scrollTop;var i=r.clientTop||l.clientTop||0;var s=n.top+o-i;return{top:s,bottom:s+t.offsetHeight}}},{key:"getDocumentProperties",value:function e(){var t=document.body;var n=document.documentElement;var l=n.clientHeight;var r=Math.max(t.scrollHeight,n.scrollHeight,t.offsetHeight,n.offsetHeight,t.clientHeight,l);return{windowHeight:l,documentHeight:r,documentScrollTop:window.pageYOffset||n.scrollTop}}},{key:"scrollDocumentTo",value:function e(t){var n=N.getDocumentProperties(),l=n.windowHeight,r=n.documentHeight;window.scrollTo(0,r/l*t["clientY"])}},{key:"scrollDocumentToElement",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.focusElement,l=n===undefined?null:n,r=t.scrollElement,o=r===undefined?null:r,i=t.scrollType,s=i===undefined?"top":i;var a=arguments[1];var u=null;if(l!=null){l.focus();u=l}if(o!=null){u=o}if(u==null){a.stopPropagation();return}if(s==="top"){u.scrollIntoView(true)}else if(s==="bottom"){u.scrollIntoView(false)}else if(s==="middle"){var c=N.getDocumentProperties(),d=c.windowHeight,f=c.documentHeight;var m=N.getElementCoordinates(u),v=m.top;var p=d/2;if(v-p<0){u.scrollIntoView(true)}else{if(v+p>f){u.scrollIntoView(false)}else{window.scrollTo(0,v-p)}}}a.stopPropagation()}}]);return N}();t.default=r}])["default"]});
//# sourceMappingURL=dom-vertical-mini-map.js.map